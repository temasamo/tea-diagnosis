# お茶診断機能の説明

## ①「お茶クイック診断」- スピード重視の診断機能

### 特徴
- **所要時間**: 約2-3分で完了
- **診断方式**: 6つの質問に順番に回答する形式
- **質問内容**: 気分、体調、時間帯、好み、場面、期待する効果
- **技術**: RAG（Retrieval-Augmented Generation）を活用したAI推奨

### 診断フロー
1. 6つの質問に順番に回答
2. AIが回答を分析し、データベースから関連記事を検索
3. おすすめのお茶、甘味料、お茶菓子を具体的に提案
4. 関連記事も一緒に表示
5. 提案された商品をAmazon・楽天・Yahooショップで購入可能

### 提案内容
- **お茶の種類**: カモミールティー、ペパーミントティー、緑茶、紅茶など具体的な商品名
- **甘味料**: はちみつ、和三盆糖、黒糖など
- **お茶菓子**: どら焼き、和菓子、クッキーなど
- **推奨理由**: AIが生成した自然な文章で説明

### ユーザー向け説明文
「お茶クイック診断は、6つの簡単な質問に答えるだけで、あなたにぴったりのお茶を提案します。AIがあなたの回答を分析し、データベースから関連記事を検索して、お茶・甘味料・お茶菓子のセットを具体的に提案します。提案された商品は、Amazon・楽天・Yahooショップでそのまま購入できます。」

---

## ②「お茶診断（開発中）」- 会話型の詳細診断機能

### 特徴
- **所要時間**: 自由（会話の長さに応じて変化）
- **診断方式**: 自由な会話形式で対話
- **技術**: より高度なAI会話エンジンを使用
- **状態**: 開発中（購入機能は未実装）

### 診断フロー
1. 季節や時間帯に応じた挨拶から開始
2. ユーザーが自由に体調や悩みを入力
3. AIが会話を理解し、最適なお茶を提案
4. 必要に応じて追加質問をして詳細を確認
5. 最大3つまで異なるお茶を提案
6. 提案後は、追加の質問や相談が可能

### 提案内容
- **お茶の種類**: 具体的なお茶の名前
- **推奨理由**: なぜこのお茶が良いかの説明
- **飲み方**: 淹れ方の詳細
- **甘味料**: おすすめの甘味料
- **合う食べ物**: 一緒に食べると良いお茶菓子
- **おすすめタイミング**: いつ飲むのが良いか

### 特徴的な機能
- **質問の重複チェック**: 同じ質問を繰り返さない
- **文脈理解**: ユーザーの状態（疲れている、リラックスしたいなど）に応じた提案
- **季節対応**: 季節や時間帯に応じた挨拶
- **柔軟な会話**: ユーザーの自由な入力に対応

### ユーザー向け説明文
「お茶診断は、自由な会話形式であなたの体調や悩みをお聞きして、最適なお茶を提案します。茶ソムリエAIがあなたの状況を理解し、お茶の種類だけでなく、飲み方、甘味料、合う食べ物、おすすめのタイミングまで詳しくご提案します。現在開発中の機能で、より高度な診断が可能です。」

---

## 2つの診断機能の違い

| 項目 | ①お茶クイック診断 | ②お茶診断（開発中） |
|------|------------------|---------------------|
| **診断方式** | 6つの質問に回答 | 自由な会話形式 |
| **所要時間** | 約2-3分 | 自由（会話の長さに応じて） |
| **提案内容** | お茶・甘味料・お茶菓子 | お茶・飲み方・甘味料・食べ物・タイミング |
| **購入機能** | ✅ あり（Amazon・楽天・Yahoo） | ❌ なし（開発中） |
| **関連記事** | ✅ 表示される | ❌ 未実装 |
| **RAG連携** | ✅ あり | ❌ なし |
| **状態** | ✅ 完成版 | 🔄 開発中 |

---

## 開発者向け技術説明

### ①お茶クイック診断
- **フロントエンド**: React (Next.js 15)
- **API**: `/api/quick-diagnosis`
- **RAG**: Supabase RPC `match_tea_articles` を使用したベクトル検索
- **AI**: OpenAI GPT-4（推奨生成）、GPT-4o-mini（Embeddings）
- **データベース**: Supabase `tea_articles` テーブル

### ②お茶診断（開発中）
- **フロントエンド**: React (Next.js 15)
- **API**: `/api/diagnose`
- **AI**: OpenAI GPT-4（会話生成）
- **特徴**: 会話履歴管理、質問重複チェック、フェーズ管理

